{{ 'video-banner.css' | asset_url | stylesheet_tag }}

{% liquid 
  assign desktop_video = section.settings.video
  assign mobile_video = section.settings.mobile_video | default: desktop_video
  assign cover_image = section.settings.cover_image | default: blank
%}

<div class="video-banner">
  {% if desktop_video or mobile_video %}
    <video 
      class="video-banner__video" 
      playsinline 
      autoplay 
      muted 
      loop 
      poster="{{ cover_image | image_url: 'master' }}"
    >
      {% if desktop_video %}
        <source 
          src="{{ desktop_video.sources[0].url }}" 
          type="{{ desktop_video.sources[0].mime_type }}"
        >
      {% endif %}
      
      {% if mobile_video and mobile_video != desktop_video %}
        <source 
          src="{{ mobile_video.sources[0].url }}" 
          type="{{ mobile_video.sources[0].mime_type }}"
        >
      {% endif %}
      
      Your browser does not support the video tag.
    </video>
  {% elsif cover_image %}
    {{ cover_image | image_url: width: 2000 | image_tag: 
      class: 'video-banner__video',
      loading: 'lazy',
      alt: cover_image.alt | escape
    }}
  {% endif %}

  <div 
    class="video-banner__overlay" 
    style="
      background-color: {{ section.settings.overlay_color }};
      opacity: {{ section.settings.overlay_opacity | divided_by: 100.0 }};
    "
  ></div>

  <div class="video-banner__content" style="text-align: {{ section.settings.text_alignment }};">
    {% if section.settings.title != blank %}
      <h1 class="video-banner__title">{{ section.settings.title }}</h1>
    {% endif %}
    
    {% if section.settings.description != blank %}
      <p class="video-banner__description">{{ section.settings.description }}</p>
    {% endif %}
  </div>
</div>